<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Steam Review Sentiment Analysis Demo</title>
    <style>
        /* Keep all your original styling (container, header, stats-section, review-card, etc.) */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 25px 50px rgba(0,0,0,0.15); overflow: hidden; }
        .header { background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%); color: white; padding: 40px; text-align: center; position: relative; overflow: hidden; }
        h1, h2, h3, h4 { margin-bottom: 15px; }
        .review-card { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); border-left: 5px solid #3498db; margin-bottom: 20px; }
        .review-card.positive { border-left-color: #27ae60; }
        .review-card.negative { border-left-color: #e74c3c; }
        .review-text { line-height: 1.8; font-size: 1.1em; color: #444; margin: 15px 0; padding: 20px; background: #f8f9fa; border-radius: 10px; border-left: 3px solid #3498db; font-style: italic; }
        .review-meta { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .sentiment-badge.positive { background: linear-gradient(45deg, #27ae60, #2ecc71); color: white; padding: 5px 12px; border-radius: 20px; }
        .sentiment-badge.negative { background: linear-gradient(45deg, #e74c3c, #c0392b); color: white; padding: 5px 12px; border-radius: 20px; }
        button { padding: 12px 25px; font-size: 1em; margin: 10px 5px; cursor: pointer; border: none; border-radius: 25px; color: white; }
        #runBtn { background: linear-gradient(45deg, #3498db, #2c3e50); }
        #loadBtn { background: linear-gradient(45deg, #1e3a8a, #1e40af); }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ® Steam Review Sentiment Analysis</h1>
            <p>AI-Powered Game Review Analysis Dashboard</p>
        </div>

        <div style="padding: 20px;">
            <button id="runBtn" onclick="runSentimentAnalysis()">ğŸ” Run Sentiment Analysis</button>
            <button id="loadBtn" onclick="loadResults()">ğŸ“Š Load Latest Results</button>
            <div id="analysisStatus" style="margin-top: 10px; font-style: italic; color: #666;"></div>
        </div>

        <div id="liveResults" style="display:none; padding: 20px;">
            <h2>ğŸ“Š Live Results</h2>
            <div id="resultsContent"></div>
        </div>
    </div>

    <script>
        // Trigger Python server analysis simulation
        function runSentimentAnalysis() {
            const status = document.getElementById('analysisStatus');
            status.innerHTML = 'â³ Running sentiment analysis on server...';
            
            fetch('/analyze')
                .then(response => response.json())
                .then(data => {
                    status.innerHTML = 'âœ… Analysis complete! Click "Load Latest Results" to view.';
                    console.log('Live analysis data:', data);
                })
                .catch(err => {
                    status.innerHTML = 'âŒ Error running analysis!';
                    console.error(err);
                });
        }

        // Load results from server.py dynamically
        async function loadResults() {
            const resultsDiv = document.getElementById('liveResults');
            const contentDiv = document.getElementById('resultsContent');
            
            resultsDiv.style.display = 'block';
            contentDiv.innerHTML = 'â³ Loading...';

            try {
                const response = await fetch('/analyze');
                const data = await response.json();

                let html = `<p><strong>App ID:</strong> ${data.app_id} | <strong>Total Reviews:</strong> ${data.total_reviews} | <strong>Timestamp:</strong> ${data.timestamp}</p>`;

                // Most positive paragraphs
                html += `<h3 style="color: #27ae60;">ğŸŒŸ Top Positive Paragraphs</h3>`;
                data.most_positive.forEach((p, idx) => {
                    html += `<div class="review-card positive">
                                <div class="review-meta">
                                    <span class="sentiment-badge positive">ğŸ˜Š ${p.normalized_score.toFixed(3)}</span>
                                </div>
                                <div class="review-text">${p.sentence}</div>
                            </div>`;
                });

                // Most negative paragraphs
                html += `<h3 style="color: #e74c3c;">ğŸ’” Top Negative Paragraphs</h3>`;
                data.most_negative.forEach((p, idx) => {
                    html += `<div class="review-card negative">
                                <div class="review-meta">
                                    <span class="sentiment-badge negative">ğŸ˜ ${p.normalized_score.toFixed(3)}</span>
                                </div>
                                <div class="review-text">${p.sentence}</div>
                            </div>`;
                });

                contentDiv.innerHTML = html;

            } catch (error) {
                contentDiv.innerHTML = '<p style="color: #e74c3c;">âŒ Failed to load results. Make sure server.py is running!</p>';
                console.error(error);
            }
        }
    </script>
</body>
</html>
